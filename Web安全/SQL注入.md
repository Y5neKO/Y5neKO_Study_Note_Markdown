# SQL注入

## 注入分类

**按注入方式**

- 盲注
  1. 布尔盲注：只能从执行语句后的布尔值来判断
  2. 时间盲注：没有明确的回显，只能使用特定的时间函数来判断，比如sleep等。

- 报错注入

  应用会显示全部或者部分的报错信息

- 堆叠注入

  可以使用半角分号分隔，一次执行多条语句

**按参数类型**

- 数字型
- 字符型

其最大的差别在于有无引号包裹

## 注入检测

常见的注入点

**GET/POST等请求方式**

get方式注入是通过url传递，一般在页面查询或者数据库查询的时候可以用到，例如 `index.php?id=1` 等。

post方式注入是通过post表单等方式传递，一般在登录框或者数据查询功能可以用到。

**X-Forwarded-For**

> X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的**客户端最原始的IP地址**的HTTP请求头字段。 

因为缓存服务器的存在，很多大型ISP为了通过缓存的方式来降低外部带宽，所以鼓励用户采用代理服务器接入互联网。在有些情况下，一些代理服务器是透明代理，用户甚至不知道正在使用代理，如果没有XFF这类技术存在，所有通过代理服务器的网络连接只会显示代理服务器的ip地址，所以很多恶意请求的检测和防护难度大大增加，所以提出了XXF这个概念。

例：

有些情况下服务器通过后端获取XXF数据，然后又通过sql语句进行操作

```sh
String ip = request.getHeader("X-Forwarded-For");
String sql = "select * from table where ip = ' "+ip+" ' ";
```

这时候我们就可以通过抓包XXF字段来进行sql注入

**文件名**

在某些情况下，上传点上传到服务器的过程中，可能涉及到一些文件名的操作。比如用于读取文件的功能，从数据库中读取上传的文件，这个过程就很有可能触发sql注入

例：

猜测后端通过如下语句来进行上传和查询：

```sh
insert into  表名('filename',...)  values('你上传的文件名',...);
```

那么可以构造语句 `'+(selselectect database())+'` ，拼接后的sql语句为：

```sh
insert into  表名('filename',...) values('文件名'+(selselectect cdatabase())+'.jpg',...);
```

## 注入方式

**联合查询注入Union**

联合查询适合有回显的注入，